<!DOCTYPE html>
<html lang="en">
<head>
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
<script src="https://www.gstatic.com/firebasejs/5.0.4/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.0.4/firebase-database.js"></script>
<script>
var config = {
  apiKey: "AIzaSyCpfpRAi_SsGZ3-zoCg0l5SzBsDg_xCGx8",
  authDomain: "gear-catalogue.firebaseapp.com",
  databaseURL: "https://gear-catalogue.firebaseio.com",
  projectId: "gear-catalogue",
  storageBucket: "gear-catalogue.appspot.com",
  messagingSenderId: "329733455911"
};
firebase.initializeApp(config);
</script>
	
<script>
var gear = firebase.database().ref('current');
	
gear.on('value', function (snapshot) { 
  if (!snapshot.exists()) { return; }
	
  let content = document.createElement('div');
	
  snapshot.forEach(function (tableSnapshot) {
    if (!tableSnapshot.exists()) { return; }
	  
    if (tableSnapshot.key==='time') {
      let date = new Date();
      let timeStamp = d.toLocaleString(tableSnapshot.val())
      let lastUpdate = document.createElement('p');
      lastUpdate.innerHTML = Last Updated: ' + timeStamp;
      lastUpdate.id = 'time-stamp';
      content.insertBefore(lastUpdate, content.firstChild);
      return; 
    }
	
    let pageTitle = document.createElement('h1');
    pageTitle.innerHTML = tableSnapshot.key;
    
    let pageList = document.createElement('ul'); 	                         								
    		
    tableSnapshot.forEach(function (rowSnapshot) {
      if (!rowSnapshot.exists()) { return; }
	    
      let pageItem = document.createElement('li');
      pageList.appendChild(pageItem);
	    
      let itemList = document.createElement('ul');

	    
      var header = false;
      if (rowSnapshot.key == 0) { header = true; }		                        
		  
      rowSnapshot.forEach(function (dataSnapshot) {
	if (!dataSnapshot.exists()||dataSnapshot.val()==null) { return; }
	      
	if (header) { 
	
          let itemTitle = document.createElement('h2');
	  itemTitle.innerHTML = dataSnapshot.val();
	  
	  
	} else { 
		content += '<td>' + dataSnapshot.val() + '</td>'; 
	}
      }); 								
    });	
	  
    content.appendChild(pageTitle);
    content.appendChild(pageList);
  });	
	
  let noscript = document.querySelector('#ex-table');
  noscript.innerhtml = '';  // need to change how this is handled for progen
  noscript.appendChild(content);
});
</script>

<style>
table { border-collapse: collapse; }
table, th, td { border: 3px solid black; }
table { width: 80%; }
</style>
</head>

<body>
	
<div id="ex-table">Custom HTML</div>
	
</body>
